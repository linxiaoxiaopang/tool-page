(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-075779c0","chunk-85b4515c","chunk-2d85c4be","chunk-2d0d0081"],{"00b6":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("pageContainer",[r("baseTable",e._b({staticClass:"tabs-active-border--primary",attrs:{list:e.list,data:e.filterData,spanMethod:e.spanMethod},scopedSlots:e._u([{key:"menuLeft",fn:function(t){return[r("ExportExcelBtn",{staticClass:"inline-block",on:{changeData:e.changeData}},[e._v(" 导入表格 ")])]}},{key:"menu",fn:function(e){e.row}}])},"baseTable",e.$attrs,!1)),r("el-button",{staticClass:"mt18 submit-btn",attrs:{type:"primary"},on:{click:e.onsubmit}},[e._v(" 保存数据 ")])],1)},n=[],i=r("1da1"),c=r("ade3"),o=(r("d81d"),r("4de4"),r("d3b7"),r("96cf"),r("405f")),l=r("8115"),s=r("b217"),u=r("4667"),f=r("ed08"),p=r("15fd"),d=(r("7db0"),r("ac1f"),r("5319"),r("3ca3"),r("ddb0"),r("2b0e")),h=r("a15e"),b=r("2ef0"),m=["callback","isAsync","clearErrorBeforeValid"];function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.callback,n=r.isAsync,i=r.clearErrorBeforeValid,c=void 0===i||i,o=Object(p["a"])(r,m);Object(b["isArray"])(t)||(t=[t]),c&&t.map((function(e){d["default"].delete(e,"asyncValidatorErrorList")}));var l=g(e),s=new h["default"](l),u={required:"$label必填"};s.messages(u),a=a||function(t){var r=t.errors,a=(t.fields,t.row);r&&r.map((function(t){var r=t.field,n=t.message,i="_".concat(r,"_errMsg"),c=e.find((function(e){return e.prop==r})),o=$GET(c,"label","");o&&n.indexOf("$label")>=0&&(n=n.replace("$label",c.label).replace(r,"")),a.asyncValidatorErrorList||d["default"].set(a,"asyncValidatorErrorList",{}),d["default"].set(a.asyncValidatorErrorList,i,n)}))},delete r.callback;var f=[],v=[];return t.map((function(e,t){var r=f[t]={errors:[],fields:[],row:e},n=s.validate(e,o,(function(t,n){a({errors:t,fields:n,row:e}),r.errors=t,r.fields=n}));v.push(n)})),n?Promise.all(f).then((function(){return f})):f}function g(e){return e.reduce((function(e,t){var r=t.prop,a=t.rules||[];return e[r]=a,e}),{})}var y=r("2ba3"),x=r("7bdb"),S=r("65f2"),O={components:{ExportExcelBtn:u["default"]},mixins:[Object(o["default"])(),Object(l["default"])({dataAttrs:{searchForm:{},tableColumn:[],curTabItem:{}}}),Object(s["default"])()],data:function(){var e;return{errDataObj:(e={},Object(c["a"])(e,S["TYPE_BIG_GOOD"],[]),Object(c["a"])(e,S["TYPE_SMALL_GOOD"],[]),e)}},computed:{list:function(){return Object(S["getList"])()},errData:{get:function(e){var t=e.errDataObj,r=e.currentValue;return t[r]},set:function(e){this.errDataObj[this.currentValue]=e}}},methods:{onsubmit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.data.length){t.next=3;break}return e.$message.error("导入的数据不能为空！"),t.abrupt("return");case 3:if(!e.errData.length){t.next=6;break}return e.$message.error("导入的数据存在异常，无法提交。请修改后重新导入！"),t.abrupt("return");case 6:return t.next=8,awaitResolveDetailLoading(x["a"].create(e.getParams()));case 8:if(r=t.sent,r){t.next=11;break}return t.abrupt("return");case 11:e.$message.success("导入成功");case 12:case"end":return t.stop()}}),t)})))()},getParams:function(){var e=this;return{type:this.currentValue,channelPricesList:this.data.map((function(t){var r=t.cargoAttributes,a=t.countryCnName,n=t.deliveryShipping,i=t.expressShippingMethod,c=t.price,o=t.registrationFee,l=t.weight;return{type:e.currentValue,cargoAttributes:r,countryCnName:a,deliveryShipping:n,expressShippingMethod:i,price:c,registrationFee:o,weight:l}}))}},changeData:function(e){var t=v(this.tableColumn,Object(S["getFormatPrice"])(e));this.errData=t.filter((function(e){return!Object(y["e"])(e.errors)})),this.data=e},spanMethod:function(e){return Object(f["g"])(e,this.filterData,{props:[[{deliveryShipping:["deliveryShipping"]}]]})}}},_=O,k=(r("b345"),r("2877")),w=Object(k["a"])(_,a,n,!1,null,"75121e0e",null);t["default"]=w.exports},"39db":function(e,t,r){"use strict";r("911c")},4667:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("XlsxTable",{attrs:{isMergeCell:!0},on:{"on-select-file":e.onSelectFile}},[e._t("xlsxBtn",(function(){return[r("el-button",[e._v("导入表格")])]}))],2)},n=[],i=r("1da1"),c=(r("96cf"),r("d9ae")),o=r("ed08"),l={components:{XlsxTable:c["a"]},data:function(){return{data:[],transformKeys:{deliveryShipping:"出货方式",countryCnName:"国家",cargoAttributes:"货物属性",expressShippingMethod:"渠道",weight:"重量",price:"价格",registrationFee:"挂号费"}}},methods:{onSelectFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=e.body,n=void 0===a?[]:a,t.data=Object(o["c"])(n,t.transformKeys),t.$emit("changeData",t.data);case 3:case"end":return r.stop()}}),r)})))()}}},s=l,u=r("2877"),f=Object(u["a"])(s,a,n,!1,null,"5b9e0fbd",null);t["default"]=f.exports},"65f2":function(e,t,r){"use strict";r.r(t),r.d(t,"SORT_SHIPPING_METHOD_ASC",(function(){return i})),r.d(t,"SORT_ALL_ASC",(function(){return c})),r.d(t,"TYPE_BIG_GOOD",(function(){return o})),r.d(t,"TYPE_SMALL_GOOD",(function(){return l})),r.d(t,"getList",(function(){return s})),r.d(t,"createOption",(function(){return u})),r.d(t,"getSelectSearchColumn",(function(){return f})),r.d(t,"getFormatPrice",(function(){return p}));r("ac1f"),r("00b4"),r("d81d"),r("4de4"),r("d3b7"),r("841c"),r("1276"),r("25f0"),r("a9e3");var a=r("2ef0"),n=r("e26f"),i="1",c="2",o="1",l="2";function s(e,t){return{column:[{label:"大货",value:o,option:u(e,t)},{label:"小货",value:l,option:u(e,t)}]}}function u(e,t){e=e||[];var r={searchExcel:{option:{border:!0,menu:!1,isOnePage:!1,page:!1,index:!0,column:[{label:"导入时间",prop:"createTime",search:!0,$sort:8},{label:"排序方式",prop:"sort",type:"select",searchValue:i,dicData:[{label:"出货方式-价格递增",value:i},{label:"全部-价格递增",value:c}],search:!0,hide:!0},{label:"出货方式",prop:"deliveryShipping",type:"select",search:!0},{label:"国家",prop:"countryCnName",type:"select",search:!0},{label:"渠道",prop:"expressShippingMethod",type:"select",search:!0},{label:"货物属性",prop:"cargoAttributes",type:"select",search:!0},{label:"重量",prop:"weight",type:"select",search:!0,formatter:function(e){var t=e.weight,r="".concat(t);return t<21&&(r="".concat(r,'<div class="text-primary mr10">特殊</div>')),r}},{label:"价格/kg",prop:"price",search:!0,type:"select"},{label:"挂号费",prop:"registrationFee",formatter:function(e){return e.registrationFee||0}},{label:"备注",prop:"remark"}]}},exportExcel:{option:{border:!0,menu:!1,isOnePage:!1,page:!1,index:!0,column:[{label:"排序方式",prop:"sort",type:"select",searchValue:i,dicData:[{label:"出货方式-价格递增",value:i},{label:"全部-价格递增",value:c}],search:!0,hide:!0},{label:"出货方式",prop:"deliveryShipping",search:!0,rules:[{required:!0}]},{label:"国家",prop:"countryCnName",search:!0,rules:[{required:!0}]},{label:"货物属性",prop:"cargoAttributes",search:!0},{label:"渠道",prop:"expressShippingMethod",search:!0,rules:[{required:!0}]},{label:"重量",prop:"weight",search:!0,rules:[{required:!0}],formatter:function(e){var t=e.weight,r="".concat(t);return t<21&&(r="".concat(r,'<div class="text-primary mr10">特殊</div>')),r}},{label:"价格/kg",prop:"price",rules:[{required:!0},{validator:function(e,t,r,a){var i=n["b"].money.pattern.test(a.formatPrice);i?r():r(n["b"].money.message)}}]},{label:"挂号费",prop:"registrationFee",formatter:function(e){return e.registrationFee||0}},{label:"备注",prop:"remark"}]}}},o=(r[t]||r.exportExcel).option,l=f(o.column);return l.map((function(t){var r=t.prop,n=Object(a["uniq"])(Object(a["map"])(e,r)).filter(Boolean);t.multiple=!0,t.filterable=!0,t.dicData=n.map((function(e){return{value:e,label:e}}))})),o}function f(e){return e.filter((function(e){return e.search&&"select"==e.type&&"sort"!==e.prop}))}function p(e){return e=e||[],e.map((function(e){var t=e.price.toString().split(/[\s,，'‘"“、]+/)[0];return t==Number(t)?e.formatPrice=Number(t):e.formatPrice=e.price,e}))}},7334:function(e,t,r){},"7bdb":function(e,t,r){"use strict";var a=r("028f"),n={create:"/channelPricesService/channelPrices/create",list:"/channelPricesService/channelPrices/list",exportShippingMethodPriceComparison:{url:"/channelPricesService/exportShippingMethodPriceComparison",responseType:"blob"}};t["a"]=Object(a["c"])(n)},"911c":function(e,t,r){},b217:function(e,t,r){"use strict";r.r(t);var a=r("15fd"),n=r("ade3"),i=r("2909"),c=(r("c740"),r("99af"),r("d81d"),r("07ac"),r("d3b7"),r("b64b"),r("4de4"),r("ac1f"),r("00b4"),r("4d63"),r("c607"),r("2c3e"),r("25f0"),r("4e82"),r("65f2")),o=r("2ba3"),l=r("6bd7"),s=r("ed08"),u=r("2ef0"),f=["sort","createTime"];function p(e,t){var r=[];if(!t)return e;if(t==c["SORT_SHIPPING_METHOD_ASC"]){var a=[],n=Object(u["groupBy"])(e,(function(e){var t=e.deliveryShipping,r=a.findIndex((function(e){return e===t}));return r<0&&(a.push(t),r=a.length-1),"".concat(r,"_").concat(t)}));return Object.values(n).map((function(e){var t=Object(u["orderBy"])(e,["formatPrice","deliveryShipping","countryCnName"]);r.push.apply(r,Object(i["a"])(t))})),r}return Object(u["orderBy"])(e,["formatPrice","deliveryShipping","countryCnName"])}function d(e,t){return Object.keys(t).reduce((function(e,r){return e=e.filter((function(e){var a=t[r];return!!Object(o["e"])(a)||(a=Object(u["isArray"])(a)?a:[a],a.some((function(t){return new RegExp(Object(l["a"])(t),"i").test(e[r])})))})),e}),e)}t["default"]=function(){return{data:function(){var e;return{dataObj:(e={},Object(n["a"])(e,c["TYPE_BIG_GOOD"],[]),Object(n["a"])(e,c["TYPE_SMALL_GOOD"],[]),e)}},computed:{currentValue:function(e){var t=e.curTabItem;return t.value||c["TYPE_SMALL_GOOD"]},data:{get:function(e){var t=e.dataObj,r=e.currentValue;return t[r]},set:function(e){this.dataObj[this.currentValue]=e}},filterData:function(e){var t=e.searchForm,r=e.data,n=t.sort,i=(t.createTime,Object(a["a"])(t,f));return r=p(r,n),d(r,i)}},methods:{spanMethod:function(e){return Object(s["g"])(e,this.filterData,{props:[[{deliveryShipping:["deliveryShipping"]},{countryCnName:["countryCnName"]},{expressShippingMethod:["expressShippingMethod"]},{cargoAttributes:["cargoAttributes"]}]]})}}}}},b345:function(e,t,r){"use strict";r("7334")},d9ae:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"xlsxContainer",on:{drop:function(t){return t.preventDefault(),e.onDrop.apply(null,arguments)},dragover:function(e){e.preventDefault()},dragleave:function(e){e.preventDefault()}}},[r("div",{attrs:{uiid:"zd-xlsxTable"},on:{click:e.handleUploadBtnClick}},[e._t("default",(function(){return[r("el-button",{attrs:{type:"primary"}},[e._v("上传文件")])]}))],2),r("input",{ref:e.uploadInputId,staticClass:"c-hide",attrs:{type:"file",accept:e.accept},on:{change:e.handkeFileChange}})])},n=[],i=r("1da1"),c=(r("96cf"),r("a9e3"),r("b0c0"),r("ac1f"),r("1276"),r("caad"),r("d3b7"),r("159b"),r("5cc6"),r("907a"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("72f7"),r("b64b"),r("25f0"),r("5319"),r("4de4"),r("4e82"),r("d81d"),r("25ca")),o=r("ed08"),l={name:"vue-xlsx-table",data:function(){return{rawFile:null,workbook:null,tableData:{header:[],body:[]},uploadInputId:(new Date).getUTCMilliseconds()}},props:{options:{type:Object,default:function(){return{}}},accept:{type:String,default:".xlsx, .xls"},className:{type:String,default:"xlsx-button"},limit:{type:Number,default:1/0},isMergeCell:Boolean,keepOrigin:Boolean},computed:{rABS:function(){var e={rABS:!1},t=Object.assign(e,this.options);return t.rABS}},methods:{handkeFileChange:function(e){var t=this;if(null===this.rawFile){var r=this.rawFile=e.target.files[0];if(this.checkFile(r)){var a=this.$loading({lock:!0,text:"上传中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$nextTick((function(){t.$emit("input-file",r),t.$emit("getFileName",r.name)}));var n=r.name.split(".").pop();["csv","tsv"].includes(n)?this.handleCsvFile(a):this.isMergeCell?this.handleXlsxMergeCellFile(a):this.handleXlsxFile(a)}}},onDrop:function(e){this.handkeFileChange({target:{files:e.dataTransfer.files}})},checkFile:function(e){return this.checkAccept(e)&&this.checkSize(e)},checkSize:function(e){return e.size<=this.limit||(this.$message.warning("请上传不超过".concat(this.limit/1024/1024,"M文件")),!1)},checkAccept:function(e){var t=e.name.split(".").pop();return this.accept.indexOf(t)>=0||(this.$message.warning("请上传".concat(this.accept,"文件")),!1)},handleCsvFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,i,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(o["l"])(t.rawFile);case 3:a=r.sent,n=a.Sheets[a.SheetNames[0]],t.formatNumToString(n),t.update_sheet_range(a.Sheets[a.SheetNames[0]]),i=c["b"].sheet_to_json(a.Sheets[a.SheetNames[0]]),t.workbook=a,l=t.xlsxArrToTableArr(i),t.initTable(l),r.next=15;break;case 13:r.prev=13,r.t0=r["catch"](0);case 15:e.close();case 16:case"end":return r.stop()}}),r,null,[[0,13]])})))()},handleXlsxFile:function(e){var t=this;this.fileConvertToWorkbook(this.rawFile).then((function(r){var a=r.Sheets[r.SheetNames[0]];t.formatNumToString(a),t.update_sheet_range(r.Sheets[r.SheetNames[0]]);var n=c["b"].sheet_to_json(r.Sheets[r.SheetNames[0]]);t.workbook=r,e.close(),t.initTable(t.xlsxArrToTableArr(n))})).catch((function(r){t.$emit("on-select-file",!1),e.close()}))},handleXlsxMergeCellFile:function(e){var t=this;this.fileConvertToWorkbook(this.rawFile).then((function(r){var a=r.Sheets[r.SheetNames[0]];t.dealMergeCol(a),t.formatNumToString(a),t.update_sheet_range(a);var n=c["b"].sheet_to_json(a);t.workbook=r,e.close(),t.initTable(t.xlsxArrToTableArr(n))})).catch((function(r){t.$emit("on-select-file",!1),e.close()}))},dealMergeCol:function(e){var t=e["!merges"];t&&t.forEach((function(t){var r=t.s,a=t.e,n=r.r,i=r.c,o=a.r,l=a.c,s=e[c["b"].encode_cell(r)];if(s){s.v;for(var u=n;u<=o;u++)for(var f=i;f<=l;f++){var p=c["b"].encode_cell({r:u,c:f});e[p]=s}}}))},formatNumToString:function(e){var t=/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/i.exec(e["!ref"]),r=[Math.max(t[2]-1,0),Math.max(t[4]-1,0)],a=0,n=0;while(!e[c["b"].encode_cell({c:a,r:r[0]})]&&a<99999)++a;n=a;while(e[c["b"].encode_cell({c:n,r:r[0]})])++n;for(var i={s:{c:+a,r:+r[0]},e:{c:+n,r:+r[1]}},o=i.s.c;o<=i.e.c;o++)for(var l=i.s.r;l<=i.e.r;l++){var s=e[c["b"].encode_cell({c:o,r:l})];!isNaN(Number(s&&s.v))&&String(s&&s.v).length>=12&&(s.w=s.v)}},fileConvertToWorkbook:function(e){var t=this,r=new FileReader;return new Promise((function(a,n){try{r.onload=function(e){var r=new Uint8Array(e.target.result),n=c["a"](r,{type:t.rABS?"binary":"array"});a(n)},r.onerror=function(e){n(e)},t.rABS?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}catch(i){n(i)}}))},xlsxArrToTableArr:function(e){var t=this,r=[],a={};e.forEach((function(e){Object.assign(a,e)}));var n=Object.keys(a),i=n.length,c={};return e.forEach((function(e){c={};for(var a=0;a<i;a++)"number"===typeof e[n[a]]||"string"===typeof e[n[a]]?t.keepOrigin?c[n[a]]=e[n[a]].toString():c[n[a]]=e[n[a]].toString().replace(/^\s+/,"").replace(/\s+$/,"").replace(/^['‘’]/,"")||"":c[n[a]]=e[n[a]]||"";r.push(c)})),{header:n,data:r}},tableArrToXlsxArr:function(e){var t=e.data,r=e.header,a=[],n={};return t=t||[],t.forEach((function(e){n={},e.forEach((function(e,t){n[r[t]]=e})),a.push(n)})),a},initTable:function(e){var t=e.data,r=e.header;this.tableData.header=r,this.tableData.body=t.filter((function(e){var t=r.filter((function(e){return-1===e.indexOf("EMPTY")}))[0];return e[t]})),this.$emit("on-select-file",this.tableData),this.$emit("on-select-all-file",{header:r,body:t})},handleUploadBtnClick:function(){this.clearAllData(),this.$refs[this.uploadInputId].click()},clearAllData:function(){this.$refs[this.uploadInputId].value=null,this.tableData={header:[],body:[]},this.rawFile=null,this.workbook=null},getSheetHeader:function(e,t){var r={},a=[];for(var n in e)"1"===n.replace(/[A-Z]/,"")&&(a.push(n),r[n]=e[n].w);a.sort();for(var i=a.map((function(e){return r[e]})),c=t.length-i.length,o=0;o<c;o++)0===o?i.push("__EMPTY"):i.push("__EMPTY_".concat(o));return i},update_sheet_range:function(e){var t={s:{r:1/0,c:1/0},e:{r:0,c:0}};Object.keys(e).filter((function(e){return"!"!=e.charAt(0)})).map(c["b"].decode_cell).forEach((function(e){t.s.c=Math.min(t.s.c,e.c),t.s.r=Math.min(t.s.r,e.r),t.e.c=Math.max(t.e.c,e.c),t.e.r=Math.max(t.e.r,e.r)})),e["!ref"]=c["b"].encode_range(t)}}},s=l,u=(r("39db"),r("2877")),f=Object(u["a"])(s,a,n,!1,null,"6b2ddd72",null);t["a"]=f.exports}}]);