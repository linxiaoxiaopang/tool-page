(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4169affa"],{"6d30":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{ref:"form",staticClass:"validate-form-self",class:{"is-edit":!e.disabled},style:{width:e.setPx(e.option.width)},attrs:{model:e.form,"label-width":e.setPx(e.option.labelWidth,80),"label-suffix":e.labelSuffix,"validate-on-rule-change":e.validData(e.option.validateOnRuleChange,!1),"hide-required-asterisk":e.option.hideRequiredAsterisk},on:{validate:e.handleValidate},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-table",e._g({ref:"table",staticClass:"table-border",class:{"not-empty-text":!e.hasEmptyText},attrs:{border:"",data:e.form.tableData,"row-key":e.option.rowKey,"row-class-name":e.tableRowClassName}},e.$listeners),[e.option.selection?[n("el-table-column",{attrs:{type:"selection",width:"50",align:"center",selectable:e.option.selectable,"reserve-selection":e.option.reserveSelection}})]:e._e(),e._l(e.columnOption,(function(t){return n("el-table-column",e._b({key:t.prop,attrs:{width:t.width,"min-width":t.minWidth},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t(t.prop,(function(){return[!e.getDisabled(t)&&t.children?e._l(t.children||[],(function(t){return n("el-form-item",{key:""+t.prop+e.form.tableData[a.$index].$key,class:[e.validData(t.showMessage,!1)&&"show-message"],attrs:{label:t.label,prop:"tableData["+a.$index+"]."+t.prop,rules:t.rules,"label-width":e.setPx(e.validData(t.labelWidth,e.option.labelWidth,0)),"show-message":e.validData(t.showMessage,!1)}},[e._t(t.prop,(function(){return[n(e.getComponent(t.type),e._b({tag:"component",attrs:{dic:e.getDic(t,a.row),disabled:e.getDisabled(t,a.row),size:e.validData(t.size,"small")},on:{input:function(n){return e.onCellInput(a.row,t)},change:function(n){return e.onCellChange(a.row,t)},blur:e.onblur},model:{value:e.form.tableData[a.$index][t.prop],callback:function(n){e.$set(e.form.tableData[a.$index],t.prop,n)},expression:"form.tableData[scoped.$index][item.prop]"}},"component",t,!1))]}),{row:a.row,$index:a.$index,form:e.form.tableData[a.$index],dic:e.getDic(t,a.row),disabled:e.getDisabled(t,a.row),size:e.validData(t.size,"small"),option:t},t)],2)})):[t.type||t.formatter?n("span",{domProps:{innerHTML:e._s(e.detail(a.row,t))}}):n("span",[e._v(e._s(e.validData(e.$GET(a.row,t.prop,null),t.placeholder)))])]]}),null,a)]}}],null,!0)},"el-table-column",t,!1))})),!e.disabled&&e.validData(e.option.menu,!0)?n("el-table-column",{attrs:{label:"操作",fixed:e.option.menuFixed,align:e.validData(e.option.menuAlign),"header-align":e.option.menuHeaderAlign,width:e.validData(e.option.menuWidth,240)},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("menu",null,null,t),e.validData(e.option.delBtn,!0)?n("Popover",{attrs:{disabled:!(e.canDeleteOnRemainingOne||e.form.tableData.length>1)},on:{sureHandler:function(n){return e.delTableData(t.$index)}},scopedSlots:e._u([{key:"tip",fn:function(){return[n("p",[e._v("确认删除产品？")])]},proxy:!0},{key:"reference",fn:function(t){t.scope;return[n("el-button",{attrs:{type:"text"}},[e._v("删除")])]}}],null,!0)}):e._e()]}}],null,!0)}):e._e()],2)],1)},i=[],o=n("5530"),l=n("53ca"),r=n("1da1"),u=(n("96cf"),n("4de4"),n("d3b7"),n("159b"),n("ac1f"),n("5319"),n("a434"),n("a15b"),n("d81d"),n("f6f4")),s=n("1b62"),c=n("6489"),d=n("2ef0"),f=n("ed08"),p=n("c1df"),b=n.n(p),m={mixins:[u["a"],Object(s["b"])("table",["toggleRowSelection","clearSelection"])],props:{option:{default:function(){return{}}},value:{default:function(){return[]}},prop:{default:"tableData"},disabled:Boolean,hasEmptyText:{default:!0},canDeleteOnRemainingOne:{default:!0},rowClassName:[String,Function]},data:function(){return{validateMessages:{},form:{}}},computed:{columnOption:function(e){var t=this,n=e.option,a=n.column,i=n.disabled;return i=Object(c["x"])(i,this.disabled),Object(d["cloneDeep"])(a).filter((function(e){var n;return e.disabled=Object(c["x"])(e.disabled,i),null===(n=e.children)||void 0===n||n.forEach((function(n){return n.rules=t.formatRules({rules:n.rules,label:Object(c["x"])(n.label,e.label)})})),!e.hide}))},defaultRow:function(e){var t=e.columnOption,n={};return t.forEach((function(e){var t;null===(t=e.children)||void 0===t||t.forEach((function(e){n[e.prop]=""}))})),n},labelSuffix:function(e){var t=e.option.labelSuffix;return"boolean"===typeof t?t?"：":"":Object(c["w"])(t,"：")},getters:function(e){var t=e.$store;return $GET(t,"getters",{})},allColumnDic:function(e){var t=this,n=e.columnOption,a=e.option,i=e.getters,o=Object(f["n"])(n),l=Object(c["x"])(a.dic,{});return o.reduce((function(e,n){var a=t.getDicProp(n);return a?(e[a]||(e[a]=Object(c["x"])(l[a],i[a],[])),e):e}),{})},dic:function(e){var t=e.allColumnDic;return t}},watch:{value:{handler:function(e){this.$set(this.form,"tableData",Array.isArray(e)?e:[])},immediate:!0}},methods:{detail:function(e,t){var n=Object(d["get"])(e,t.prop);if(t.formatter&&"function"===typeof t.formatter&&(n=t.formatter(e,t,n)),t.type){if(("date"==t.type||"time"==t.type||"datetime"==t.type)&&t.format){var a=t.format.replace("dd","DD").replace("yyyy","YYYY");n=b()(n).format(a)}n=Object(c["e"])(Object(c["x"])(this.dic[this.getDicProp(t)],[]),n,t.props)}return this.$set(e,t.prop,n),Object(c["x"])(n,t.placeholder)},addTableData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(d["cloneDeep"])(this.defaultRow);e.$key=+new Date,this.form.tableData.push(e),this.oninput()},delTableData:function(e){this.form.tableData.splice(e,1),this.oninput()},oninput:function(){this.$emit("input",this.form.tableData),this.dispatch("ElFormItem","el.form.change")},onblur:function(){this.$emit("blur",this.form.tableData)},onCellInput:function(e,t){"function"===typeof t.onCellInput&&t.onCellInput(e,t),this.$emit("cell-input",e,t),this.oninput()},onCellChange:function(e,t){"function"===typeof t.onCellChange&&t.onCellChange(e,t),this.$emit("cell-change",e,t),this.oninput()},handleValidate:function(e,t,n){var a=this.validateMessages;if(a[e]=t||n,t)for(var i in a)!0!==a[i]&&(n=a[i]);this.$emit("validate",this.prop,n)},validate:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",t.$refs.form.validate(e));case 1:case"end":return n.stop()}}),n)})))()},tableRowClassName:function(e){var t=[e.row.$rowClassName],n=this.rowClassName;switch(Object(l["a"])(n)){case"string":t.push(n);break;case"function":t.push(n(e,this.value));break}return t.filter(Boolean).join(" ")},toggleSelection:function(e,t){var n=this;e?e.forEach((function(e){n.toggleRowSelection(e,t)})):this.clearSelection()},getDicProp:function(e){var t=e.type,n=e.dicType,a=e.prop;return n||(t?a:null)},getDic:function(e,t){var n=this.dic;return Object(c["x"])(Object(c["u"])(e,n),n[t[e.dicData]],void 0)},formatRules:function(e){var t=e.rules,n=e.label;if(t)return t=Array.isArray(t)?t:[t],t.map((function(e){return!0===e.required?Object(o["a"])({message:"".concat(n||"该项","必填")},e):e}))},getDisabled:function(e,t){var n=e.disabled;return"function"===typeof n?n(t):Object(c["x"])(n,this.disabled)},getComponent:function(e){var t={select:"avueCrudSelect"}[e];return t||"avueCrudInput"},setPx:c["v"],validData:c["x"]}},h=m,v=(n("89f6"),n("2877")),g=Object(v["a"])(h,a,i,!1,null,"48a753d8",null);t["default"]=g.exports},"89f6":function(e,t,n){"use strict";n("ce0d")},ce0d:function(e,t,n){}}]);