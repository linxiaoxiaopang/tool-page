(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a0b959f","chunk-1c62c81a","chunk-2d0de3ae"],{"39db":function(e,t,a){"use strict";a("911c")},"414c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("pageContainer",{staticClass:"flex-column"},[a("baseTable",e._b({key:e.key,staticClass:"tabs-active-border--primary",attrs:{option:e.option,data:e.data},scopedSlots:e._u([{key:"menuLeft",fn:function(t){return[a("XlsxTable",{staticClass:"inline-block",attrs:{keepOrigin:!0},on:{"on-select-file":e.onSelectFile}}),e.data.length?a("el-button",{on:{click:e.onAnalysis}},[e._v(" 解析表格 ")]):e._e(),e.formatData.length?a("el-button",{on:{click:e.copyStyledText}},[e._v(" 复制 ")]):e._e()]}},e._l(e.column,(function(t){return{key:""+t.headerName,fn:function(){return[a("div",[a("HeaderSelect",{model:{value:t.keywordType,callback:function(a){e.$set(t,"keywordType",a)},expression:"item.keywordType"}}),e._v(" "+e._s(t.label)+" ")],1)]},proxy:!0}})),{key:"formatTitle",fn:function(t){var r=t.row;return[a("span",{domProps:{innerHTML:e._s(r.formatTitle)}})]}}],null,!0)},"baseTable",e.$attrs,!1))],1)},n=[],i=a("2909"),o=a("1da1"),c=(a("96cf"),a("4de4"),a("d3b7"),a("d81d"),a("7db0"),a("ac1f"),a("5319"),a("1276"),a("4d63"),a("c607"),a("2c3e"),a("25f0"),a("a15b"),a("498a2"),a("405f")),l=a("8115"),s=a("d9ae"),u=a("dce4"),d=a("8583"),f=a("ed08"),h=a("2ef0"),p={components:{XlsxTable:s["a"],HeaderSelect:u["default"]},mixins:[Object(c["default"])(),Object(l["default"])({dataAttrs:{curTabItem:{},tableData:[],postData:{}}})],data:function(){return{column:[],data:[],key:Object(f["D"])()}},computed:{option:function(e){var t=e.column;return{menu:!1,column:t}},formatData:function(e){var t=e.data;return t.filter((function(e){return e.formatTitle}))}},methods:{onSelectFile:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=e.body,n=void 0===r?[]:r,i=e.header,o=i.map((function(e){return{label:e,prop:e,headerName:"".concat(e,"Header")}})),o.push({label:"格式化后标题",prop:"formatTitle"}),t.data=n.map((function(e){return e.formatTitle="",e})),t.column=o,t.key=Object(f["D"])();case 6:case"end":return a.stop()}}),a)})))()},onAnalysis:function(){var e=this.column.find((function(e){return e.keywordType==d["headerDicList"].title}));if(e){var t=this.column.filter((function(e){return e.keywordType==d["headerDicList"].delete})),a=this.column.filter((function(e){return e.keywordType==d["headerDicList"].replace})),r=this.column.filter((function(e){return e.keywordType==d["headerDicList"].used})),n=this.column.filter((function(e){return e.keywordType==d["headerDicList"].color||e.keywordType==d["headerDicList"].suffix||e.keywordType==d["headerDicList"].suffixAndColor}));this.data.map((function(i){var o=i[e.prop];t.map((function(e){var t=i[e.prop],a=t.split(/,|，/);a.map((function(e){var t=new RegExp(e,"ig");o=o.replace(t,"")}))})),a.map((function(e,t){var a=i[e.prop],n=a.split(/,|，/);n.map((function(e){var a=new RegExp(e,"ig");o=r[t]?o.replace(a,i[r[t].prop]||""):o.replace(a,"")}))})),n.map((function(e){if(e.keywordType==d["headerDicList"].color){var t=i[e.prop],a=o.split(t);o=a.join("<span class='text-danger'>".concat(t,"</span>"))}else if(e.keywordType==d["headerDicList"].suffixAndColor){var r=i[e.prop];o+="<span class='text-danger'>".concat(r,"</span>")}else{var n=i[e.prop];o+=n}})),i.formatTitle=o.trim()})),this.data=Object(i["a"])(this.data)}else this.$message.error("原表题必选")},copyStyledText:function(){var e=document.createElement("div");e.style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.style.opacity=0,e.innerHTML="<div>".concat(Object(h["map"])(this.data,"formatTitle").map((function(e){return e+"<br/>"})).join(""),"</div>"),document.body.appendChild(e);var t=document.createRange();t.selectNode(e);var a=window.getSelection();a.removeAllRanges(),a.addRange(t);try{document.execCommand("copy")}catch(r){}a.removeAllRanges(),document.body.removeChild(e)}}},b=p,m=a("2877"),v=Object(m["a"])(b,r,n,!1,null,"6ffacb2b",null);t["default"]=v.exports},8583:function(e,t,a){"use strict";a.r(t),a.d(t,"headerDicList",(function(){return r})),a.d(t,"dic",(function(){return n}));a("ac1f");var r={title:"title",delete:"deleteKeyword",replace:"replaceKeyword",color:"colorKeyword",used:"usedKeyword",suffix:"suffix",suffixAndColor:"suffixAndColor"},n=[{label:"原标题",value:r.title},{label:"删除关键字",value:r.delete},{label:"待替换关键字",value:r.replace},{label:"替换关键字",value:r.used},{label:"颜色关键字",value:r.color},{label:"后缀",value:r.suffix},{label:"后缀和颜色",value:r.suffixAndColor}]},"911c":function(e,t,a){},d9ae:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xlsxContainer",on:{drop:function(t){return t.preventDefault(),e.onDrop.apply(null,arguments)},dragover:function(e){e.preventDefault()},dragleave:function(e){e.preventDefault()}}},[a("div",{attrs:{uiid:"zd-xlsxTable"},on:{click:e.handleUploadBtnClick}},[e._t("default",(function(){return[a("el-button",{attrs:{type:"primary"}},[e._v("上传文件")])]}))],2),a("input",{ref:e.uploadInputId,staticClass:"c-hide",attrs:{type:"file",accept:e.accept},on:{change:e.handkeFileChange}})])},n=[],i=a("1da1"),o=(a("96cf"),a("a9e3"),a("b0c0"),a("ac1f"),a("1276"),a("caad"),a("d3b7"),a("159b"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("b64b"),a("25f0"),a("5319"),a("4de4"),a("4e82"),a("d81d"),a("25ca")),c=a("ed08"),l={name:"vue-xlsx-table",data:function(){return{rawFile:null,workbook:null,tableData:{header:[],body:[]},uploadInputId:(new Date).getUTCMilliseconds()}},props:{options:{type:Object,default:function(){return{}}},accept:{type:String,default:".xlsx, .xls"},className:{type:String,default:"xlsx-button"},limit:{type:Number,default:1/0},isMergeCell:Boolean,keepOrigin:Boolean},computed:{rABS:function(){var e={rABS:!1},t=Object.assign(e,this.options);return t.rABS}},methods:{handkeFileChange:function(e){var t=this;if(null===this.rawFile){var a=this.rawFile=e.target.files[0];if(this.checkFile(a)){var r=this.$loading({lock:!0,text:"上传中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$nextTick((function(){t.$emit("input-file",a),t.$emit("getFileName",a.name)}));var n=a.name.split(".").pop();["csv","tsv"].includes(n)?this.handleCsvFile(r):this.isMergeCell?this.handleXlsxMergeCellFile(r):this.handleXlsxFile(r)}}},onDrop:function(e){this.handkeFileChange({target:{files:e.dataTransfer.files}})},checkFile:function(e){return this.checkAccept(e)&&this.checkSize(e)},checkSize:function(e){return e.size<=this.limit||(this.$message.warning("请上传不超过".concat(this.limit/1024/1024,"M文件")),!1)},checkAccept:function(e){var t=e.name.split(".").pop();return this.accept.indexOf(t)>=0||(this.$message.warning("请上传".concat(this.accept,"文件")),!1)},handleCsvFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(c["l"])(t.rawFile);case 3:r=a.sent,n=r.Sheets[r.SheetNames[0]],t.formatNumToString(n),t.update_sheet_range(r.Sheets[r.SheetNames[0]]),i=o["b"].sheet_to_json(r.Sheets[r.SheetNames[0]]),t.workbook=r,l=t.xlsxArrToTableArr(i),t.initTable(l),a.next=15;break;case 13:a.prev=13,a.t0=a["catch"](0);case 15:e.close();case 16:case"end":return a.stop()}}),a,null,[[0,13]])})))()},handleXlsxFile:function(e){var t=this;this.fileConvertToWorkbook(this.rawFile).then((function(a){var r=a.Sheets[a.SheetNames[0]];t.formatNumToString(r),t.update_sheet_range(a.Sheets[a.SheetNames[0]]);var n=o["b"].sheet_to_json(a.Sheets[a.SheetNames[0]]);t.workbook=a,e.close(),t.initTable(t.xlsxArrToTableArr(n))})).catch((function(a){t.$emit("on-select-file",!1),e.close()}))},handleXlsxMergeCellFile:function(e){var t=this;this.fileConvertToWorkbook(this.rawFile).then((function(a){var r=a.Sheets[a.SheetNames[0]];t.dealMergeCol(r),t.formatNumToString(r),t.update_sheet_range(r);var n=o["b"].sheet_to_json(r);t.workbook=a,e.close(),t.initTable(t.xlsxArrToTableArr(n))})).catch((function(a){t.$emit("on-select-file",!1),e.close()}))},dealMergeCol:function(e){var t=e["!merges"];t&&t.forEach((function(t){var a=t.s,r=t.e,n=a.r,i=a.c,c=r.r,l=r.c,s=e[o["b"].encode_cell(a)];if(s){s.v;for(var u=n;u<=c;u++)for(var d=i;d<=l;d++){var f=o["b"].encode_cell({r:u,c:d});e[f]=s}}}))},formatNumToString:function(e){var t=/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/i.exec(e["!ref"]),a=[Math.max(t[2]-1,0),Math.max(t[4]-1,0)],r=0,n=0;while(!e[o["b"].encode_cell({c:r,r:a[0]})]&&r<99999)++r;n=r;while(e[o["b"].encode_cell({c:n,r:a[0]})])++n;for(var i={s:{c:+r,r:+a[0]},e:{c:+n,r:+a[1]}},c=i.s.c;c<=i.e.c;c++)for(var l=i.s.r;l<=i.e.r;l++){var s=e[o["b"].encode_cell({c:c,r:l})];!isNaN(Number(s&&s.v))&&String(s&&s.v).length>=12&&(s.w=s.v)}},fileConvertToWorkbook:function(e){var t=this,a=new FileReader;return new Promise((function(r,n){try{a.onload=function(e){var a=new Uint8Array(e.target.result),n=o["a"](a,{type:t.rABS?"binary":"array"});r(n)},a.onerror=function(e){n(e)},t.rABS?a.readAsBinaryString(e):a.readAsArrayBuffer(e)}catch(i){n(i)}}))},xlsxArrToTableArr:function(e){var t=this,a=[],r={};e.forEach((function(e){Object.assign(r,e)}));var n=Object.keys(r),i=n.length,o={};return e.forEach((function(e){o={};for(var r=0;r<i;r++)"number"===typeof e[n[r]]||"string"===typeof e[n[r]]?t.keepOrigin?o[n[r]]=e[n[r]].toString():o[n[r]]=e[n[r]].toString().replace(/^\s+/,"").replace(/\s+$/,"").replace(/^['‘’]/,"")||"":o[n[r]]=e[n[r]]||"";a.push(o)})),{header:n,data:a}},tableArrToXlsxArr:function(e){var t=e.data,a=e.header,r=[],n={};return t=t||[],t.forEach((function(e){n={},e.forEach((function(e,t){n[a[t]]=e})),r.push(n)})),r},initTable:function(e){var t=e.data,a=e.header;this.tableData.header=a,this.tableData.body=t.filter((function(e){var t=a.filter((function(e){return-1===e.indexOf("EMPTY")}))[0];return e[t]})),this.$emit("on-select-file",this.tableData),this.$emit("on-select-all-file",{header:a,body:t})},handleUploadBtnClick:function(){this.clearAllData(),this.$refs[this.uploadInputId].click()},clearAllData:function(){this.$refs[this.uploadInputId].value=null,this.tableData={header:[],body:[]},this.rawFile=null,this.workbook=null},getSheetHeader:function(e,t){var a={},r=[];for(var n in e)"1"===n.replace(/[A-Z]/,"")&&(r.push(n),a[n]=e[n].w);r.sort();for(var i=r.map((function(e){return a[e]})),o=t.length-i.length,c=0;c<o;c++)0===c?i.push("__EMPTY"):i.push("__EMPTY_".concat(c));return i},update_sheet_range:function(e){var t={s:{r:1/0,c:1/0},e:{r:0,c:0}};Object.keys(e).filter((function(e){return"!"!=e.charAt(0)})).map(o["b"].decode_cell).forEach((function(e){t.s.c=Math.min(t.s.c,e.c),t.s.r=Math.min(t.s.r,e.r),t.e.c=Math.max(t.e.c,e.c),t.e.r=Math.max(t.e.r,e.r)})),e["!ref"]=o["b"].encode_range(t)}}},s=l,u=(a("39db"),a("2877")),d=Object(u["a"])(s,r,n,!1,null,"6b2ddd72",null);t["a"]=d.exports},dce4:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("avue-crud-select",e._g(e._b({attrs:{dic:e.dic}},"avue-crud-select",e.$attrs,!1),e.$listeners))},n=[],i=a("8583"),o={data:function(){return{dic:i["dic"]}}},c=o,l=a("2877"),s=Object(l["a"])(c,r,n,!1,null,null,null);t["default"]=s.exports}}]);